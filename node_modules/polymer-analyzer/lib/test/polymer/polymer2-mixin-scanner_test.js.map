{"version":3,"sources":["test/polymer/polymer2-mixin-scanner_test.ts"],"names":[],"mappings":"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","file":"polymer2-mixin-scanner_test.js","sourcesContent":["/**\n * @license\n * Copyright (c) 2016 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n\nimport {assert} from 'chai';\nimport * as path from 'path';\n\nimport {Analyzer} from '../../core/analyzer';\nimport {ClassScanner} from '../../javascript/class-scanner';\nimport {Visitor} from '../../javascript/estree-visitor';\nimport {JavaScriptParser} from '../../javascript/javascript-parser';\nimport {PolymerElementMixin, ScannedPolymerElementMixin} from '../../polymer/polymer-element-mixin';\nimport {FSUrlLoader} from '../../url-loader/fs-url-loader';\nimport {CodeUnderliner} from '../test-utils';\n\nsuite('Polymer2MixinScanner', () => {\n  const testFilesDir = path.resolve(__dirname, '../static/polymer2/');\n  const urlLoader = new FSUrlLoader(testFilesDir);\n  const underliner = new CodeUnderliner(urlLoader);\n  const analyzer = new Analyzer({urlLoader});\n\n  async function getScannedMixins(filename: string) {\n    const file = await urlLoader.load(filename);\n    const parser = new JavaScriptParser();\n    const document = parser.parse(file, filename);\n    const scanner = new ClassScanner();\n    const visit = (visitor: Visitor) =>\n        Promise.resolve(document.visit([visitor]));\n    const {features} = await scanner.scan(document, visit);\n    return <ScannedPolymerElementMixin[]>features.filter(\n        (e) => e instanceof ScannedPolymerElementMixin);\n  };\n\n  async function getMixins(filename: string) {\n    const analysis = await analyzer.analyze([filename]);\n    return Array.from(analysis.getFeatures({kind: 'polymer-element-mixin'}));\n  };\n\n  async function getTestProps(mixin: ScannedPolymerElementMixin|\n                              PolymerElementMixin) {\n    const properties = [];\n    for (const name of mixin.properties.keys()) {\n      properties.push({name});\n    }\n    const attributes = [];\n    for (const name of mixin.attributes.keys()) {\n      attributes.push({name});\n    }\n    const methods = [];\n    for (const {name, params, return: r} of mixin.methods.values()) {\n      let processedParams = undefined;\n      if (params) {\n        processedParams = params.map(({name, type, description}) => {\n          const result: any = {name};\n          if (type != null) {\n            result.type = type;\n          }\n          if (description != null) {\n            result.description = description;\n          }\n          return result;\n        });\n      }\n      methods.push({name, return: r, params: processedParams});\n    }\n    const {name, description, summary} = mixin;\n    return {\n      name,\n      description,\n      summary,\n      properties,\n      attributes,\n      methods,\n      underlinedWarnings: await underliner.underline(mixin.warnings)\n    };\n  }\n\n  test('finds mixin function declarations', async() => {\n    const mixins = await getScannedMixins('test-mixin-1.js');\n    const mixinData = await Promise.all(mixins.map(getTestProps));\n    assert.deepEqual(mixinData, [{\n                       name: 'TestMixin',\n                       description: 'A mixin description',\n                       summary: 'A mixin summary',\n                       properties: [{\n                         name: 'foo',\n                       }],\n                       attributes: [{\n                         name: 'foo',\n                       }],\n                       methods: [],\n                       underlinedWarnings: []\n                     }]);\n    const underlinedSource = await underliner.underline(mixins[0].sourceRange);\n    assert.deepEqual(underlinedSource, `\nfunction TestMixin(superclass) {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n  return class extends superclass {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    static get properties() {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      return {\n~~~~~~~~~~~~~~\n        foo: {\n~~~~~~~~~~~~~~\n          notify: true,\n~~~~~~~~~~~~~~~~~~~~~~~\n          type: String,\n~~~~~~~~~~~~~~~~~~~~~~~\n        },\n~~~~~~~~~~\n      };\n~~~~~~~~\n    }\n~~~~~\n  }\n~~~\n}\n~`);\n  });\n\n  test('finds mixin arrow function expressions', async() => {\n    const mixins = await getScannedMixins('test-mixin-2.js');\n    const mixinData = await Promise.all(mixins.map(getTestProps));\n    assert.deepEqual(mixinData, [{\n                       name: 'Polymer.TestMixin',\n                       description: 'A mixin description',\n                       summary: 'A mixin summary',\n                       properties: [{\n                         name: 'foo',\n                       }],\n                       attributes: [{\n                         name: 'foo',\n                       }],\n                       methods: [],\n                       underlinedWarnings: []\n                     }]);\n    const underlinedSource = await underliner.underline(mixins[0].sourceRange);\n    assert.deepEqual(underlinedSource, `\nconst TestMixin = (superclass) => class extends superclass {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n  static get properties() {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    return {\n~~~~~~~~~~~~\n      foo: {\n~~~~~~~~~~~~\n        notify: true,\n~~~~~~~~~~~~~~~~~~~~~\n        type: String,\n~~~~~~~~~~~~~~~~~~~~~\n      },\n~~~~~~~~\n    };\n~~~~~~\n  }\n~~~\n}\n~`);\n  });\n\n  test('finds mixin function expressions', async() => {\n    const mixins = await getScannedMixins('test-mixin-3.js');\n    const mixinData = await Promise.all(mixins.map(getTestProps));\n    assert.deepEqual(mixinData, [{\n                       name: 'Polymer.TestMixin',\n                       description: '',\n                       summary: '',\n                       properties: [{\n                         name: 'foo',\n                       }],\n                       attributes: [{\n                         name: 'foo',\n                       }],\n                       methods: [],\n                       underlinedWarnings: [],\n                     }]);\n    const underlinedSource = await underliner.underline(mixins[0].sourceRange);\n    assert.deepEqual(underlinedSource, `\nconst TestMixin = function(superclass) {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n  return class extends superclass {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    static get properties() {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      return {\n~~~~~~~~~~~~~~\n        foo: {\n~~~~~~~~~~~~~~\n          notify: true,\n~~~~~~~~~~~~~~~~~~~~~~~\n          type: String,\n~~~~~~~~~~~~~~~~~~~~~~~\n        },\n~~~~~~~~~~\n      };\n~~~~~~~~\n    }\n~~~~~\n  }\n~~~\n}\n~`);\n  });\n\n  test(\n      'finds mixin variable declaration with only name, does not use trailing function',\n      async() => {\n        const mixins = await getScannedMixins('test-mixin-4.js');\n        const mixinData = await Promise.all(mixins.map(getTestProps));\n        assert.deepEqual(mixinData, [{\n                           name: 'Polymer.TestMixin',\n                           description: '',\n                           summary: '',\n                           properties: [],\n                           attributes: [],\n                           methods: [],\n                           underlinedWarnings: [],\n                         }]);\n        const underlinedSource =\n            await underliner.underline(mixins[0].sourceRange);\n        assert.deepEqual(underlinedSource, `\nlet TestMixin;\n~~~~~~~~~~~~~~`);\n      });\n\n  test('what to do on a class marked @mixinFunction?', async() => {\n    const mixins = await getScannedMixins('test-mixin-5.js');\n    const mixinData = mixins.map(getTestProps);\n    assert.deepEqual(mixinData, []);\n  });\n\n  test('finds mixin function declaration with only name', async() => {\n    const mixins = await getScannedMixins('test-mixin-6.js');\n    const mixinData = await Promise.all(mixins.map(getTestProps));\n    assert.deepEqual(mixinData, [{\n                       name: 'Polymer.TestMixin',\n                       description: '',\n                       summary: '',\n                       properties: [],\n                       attributes: [],\n                       methods: [],\n                       underlinedWarnings: []\n                     }]);\n    const underlinedSource = await underliner.underline(mixins[0].sourceRange);\n    assert.deepEqual(underlinedSource, `\nfunction TestMixin() {\n~~~~~~~~~~~~~~~~~~~~~~\n}\n~`);\n  });\n\n  test('finds mixin assigned to a namespace', async() => {\n    const mixins = await getScannedMixins('test-mixin-7.js');\n    const mixinData = await Promise.all(mixins.map(getTestProps));\n    assert.deepEqual(mixinData, [{\n                       name: 'Polymer.TestMixin',\n                       description: '',\n                       summary: '',\n                       properties: [{\n                         name: 'foo',\n                       }],\n                       attributes: [{\n                         name: 'foo',\n                       }],\n                       methods: [],\n                       underlinedWarnings: [],\n                     }]);\n    const underlinedSource = await underliner.underline(mixins[0].sourceRange);\n    assert.deepEqual(underlinedSource, `\nPolymer.TestMixin = Polymer.woohoo(function TestMixin(base) {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n  /**\n~~~~~\n   * @mixinClass\n~~~~~~~~~~~~~~~~\n   * @polymer\n~~~~~~~~~~~~~\n   */\n~~~~~\n  class TestMixin extends base {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    static get properties() {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      return {\n~~~~~~~~~~~~~~\n        foo: {\n~~~~~~~~~~~~~~\n          notify: true,\n~~~~~~~~~~~~~~~~~~~~~~~\n          type: String,\n~~~~~~~~~~~~~~~~~~~~~~~\n        },\n~~~~~~~~~~\n      };\n~~~~~~~~\n    };\n~~~~~~\n  };\n~~~~\n  return TestMixin;\n~~~~~~~~~~~~~~~~~~~\n});\n~~`);\n  });\n\n  test(\n      'properly analyzes nested mixin assignments with memberof tags',\n      async() => {\n        const mixins = await getScannedMixins('test-mixin-8.js');\n        const mixinData = await Promise.all(mixins.map(getTestProps));\n        assert.deepEqual(mixinData, [{\n                           name: 'Polymer.TestMixin',\n                           description: '',\n                           summary: '',\n                           properties: [{\n                             name: 'foo',\n                           }],\n                           attributes: [{\n                             name: 'foo',\n                           }],\n                           methods: [],\n                           underlinedWarnings: [],\n                         }]);\n\n      });\n\n  test('properly analyzes mixin instance and class methods', async() => {\n    const mixins = await getScannedMixins('test-mixin-9.js');\n    const mixinData = await Promise.all(mixins.map(getTestProps));\n    assert.deepEqual(mixinData, [\n      {\n        name: 'TestMixin',\n        description: 'A mixin description',\n        summary: 'A mixin summary',\n        properties: [{\n          name: 'foo',\n        }],\n        attributes: [{\n          name: 'foo',\n        }],\n        methods: [\n          {name: 'customInstanceFunction', params: [], return: undefined},\n          {\n            name: 'customInstanceFunctionWithJSDoc',\n            params: [], return: {\n              desc: 'The number 5, always.',\n              type: 'Number',\n            },\n          },\n          {\n            name: 'customInstanceFunctionWithParams',\n            params: [{name: 'a'}, {name: 'b'}, {name: 'c'}], return: undefined,\n          },\n          {\n            name: 'customInstanceFunctionWithParamsAndJSDoc',\n            params: [\n              {\n                name: 'a',\n                type: 'Number',\n                description: 'The first argument',\n              },\n              {\n                name: 'b',\n                type: 'Number',\n              },\n              {\n                name: 'c',\n                type: 'Number',\n                description: 'The third argument',\n              }\n            ],\n            return: {\n              desc: 'The number 7, always.',\n              type: 'Number',\n            },\n          },\n          {\n            name: 'customInstanceFunctionWithParamsAndPrivateJSDoc',\n            params: [], return: undefined,\n          },\n        ],\n        underlinedWarnings: [],\n      }\n    ]);\n\n  });\n\n  test('applies mixins to mixins', async() => {\n    const mixins = await getMixins('test-mixin-10.js');\n    const mixinData = await Promise.all(mixins.map(getTestProps));\n    assert.deepEqual(mixinData, [\n      {\n        name: 'Base',\n        description: '',\n        summary: '',\n        attributes: [{name: 'foo'}],\n        methods: [\n          {name: 'baseMethod', params: [], return: undefined},\n          {name: 'privateMethod', params: [], return: undefined},\n          {name: 'privateOverriddenMethod', params: [], return: undefined},\n          {name: 'overrideMethod', params: [], return: undefined},\n        ],\n        properties: [{name: 'foo'}],\n        underlinedWarnings: [],\n      },\n      {\n        name: 'Middle',\n        attributes: [{name: 'foo'}],\n        description: '',\n        methods: [\n          {name: 'baseMethod', params: [], return: undefined},\n          {name: 'privateMethod', params: [], return: undefined},\n          {name: 'privateOverriddenMethod', params: [], return: undefined},\n          {name: 'overrideMethod', params: [], return: undefined},\n          {name: 'middleMethod', params: [], return: undefined},\n        ],\n        properties: [{name: 'foo'}],\n        summary: '',\n        underlinedWarnings: [`\n    privateOverriddenMethod() { }\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~`],\n      }\n    ]);\n  });\n\n  test('infers properties from the constructor', async() => {\n    const mixins = await getMixins('test-mixin-11.js');\n    const mixinData = await Promise.all(mixins.map(getTestProps));\n    assert.deepEqual(mixinData, [\n      {\n        name: 'TestMixin',\n        description: '',\n        summary: '',\n        attributes: [{name: 'foo'}],\n        methods: [],\n        properties: [\n          {\n            name: 'foo',\n          },\n          {name: 'constructorProp'}\n        ],\n        underlinedWarnings: [],\n      },\n    ]);\n\n    const [mixin] = mixins;\n    assert.containSubset([...mixin.properties.values()], [\n      {\n        name: 'foo',\n        privacy: 'public',\n        description: 'This description is in the constructor.',\n        type: 'string',\n        published: true,\n        notify: true,\n        warnings: [],\n      },\n      {\n        name: 'constructorProp',\n        default: '10',\n        description: 'This property is defined only in the constructor.',\n        privacy: 'public',\n        warnings: [],\n      }\n    ]);\n  });\n});\n"]}